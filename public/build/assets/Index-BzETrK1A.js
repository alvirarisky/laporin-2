import{X as U,r as l,j as e,S as T,A as g}from"./app-CcNMjsvK.js";import{A as P}from"./AuthenticatedLayout-BLGgl2Cn.js";import"./transition-0YHYq-iH.js";function A({auth:f,templates:w,laporans:k}){const{flash:r}=U().props,[z,c]=l.useState(!1),[p,b]=l.useState(null),[o,h]=l.useState(""),[j,v]=l.useState(!1),[x,u]=l.useState(!1),[n,y]=l.useState(""),[s,m]=l.useState({name:"",template_file:null,description:"",is_public:!1}),[a,d]=l.useState({judul:"",report_type:"Makalah",mata_kuliah:"",nim:f.user.nim||"",prodi:"",instansi:""}),N=w.filter(i=>{var t;return i.name.toLowerCase().includes(n.toLowerCase())||i.description&&i.description.toLowerCase().includes(n.toLowerCase())||((t=i.user)==null?void 0:t.name)&&i.user.name.toLowerCase().includes(n.toLowerCase())}),C=i=>{if(i.preventDefault(),!s.name||!s.template_file){alert("Mohon isi nama template dan pilih file!");return}g.post(route("templates.store"),{_method:"post",name:s.name,template_file:s.template_file,description:s.description,is_public:s.is_public},{forceFormData:!0,onStart:()=>u(!0),onFinish:()=>u(!1),onSuccess:()=>{c(!1),m({name:"",template_file:null,description:"",is_public:!1})},onError:t=>{alert("Gagal upload: "+JSON.stringify(t))}})},_=i=>{i.preventDefault(),u(!0);const t=o?route("templates.apply",{template:p,laporan:o}):route("templates.use",{template:p}),S=o?{replace_existing:j}:{...a};g.post(t,S,{onFinish:()=>u(!1),onSuccess:()=>{b(null),h(""),v(!1),d({judul:"",mata_kuliah:"",nim:"",prodi:"",instansi:""})},onError:M=>{console.error("Template Error:",M),alert("Gagal memproses template. Cek inputan.")}})},L=i=>{confirm("Yakin ingin menghapus template ini?")&&g.delete(route("templates.destroy",i))};return e.jsxs(P,{user:f.user,header:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 w-full",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"font-bold text-2xl text-white leading-tight flex items-center gap-2",children:[e.jsx("span",{className:"text-indigo-400"})," Manajemen Template"]}),e.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Upload format laporan (.docx) biar gak ngetik ulang format terus."})]}),e.jsxs("div",{className:"flex w-full sm:w-auto items-center gap-3",children:[e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-zinc-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",value:n,onChange:i=>y(i.target.value),className:"block w-full pl-10 pr-3 py-2 border border-zinc-700 rounded-xl leading-5 bg-zinc-900 text-zinc-300 placeholder-zinc-500 focus:outline-none focus:bg-zinc-800 focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500 sm:text-sm transition duration-150 ease-in-out",placeholder:"Cari template..."})]}),e.jsxs("button",{onClick:()=>c(!0),className:"shrink-0 inline-flex items-center gap-2 px-5 py-2.5 bg-indigo-600 text-white font-bold rounded-xl shadow-[0_0_15px_rgba(79,70,229,0.4)] hover:bg-indigo-500 hover:shadow-[0_0_25px_rgba(79,70,229,0.6)] hover:-translate-y-1 transition-all duration-300 border border-indigo-400/30",children:[e.jsx("span",{children:"ðŸ“¤"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Upload"})]})]})]}),children:[e.jsx(T,{title:"Template - Laporin"}),e.jsx("div",{className:"py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(r==null?void 0:r.success)&&e.jsxs("div",{className:"mb-6 p-4 bg-emerald-500/10 text-emerald-400 border border-emerald-500/20 rounded-xl shadow-lg flex items-center gap-3 animate-fade-in-up",children:[e.jsx("span",{children:"âœ…"})," ",r.success]}),(r==null?void 0:r.error)&&e.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 text-red-400 border border-red-500/20 rounded-xl shadow-lg flex items-center gap-3 animate-fade-in-up",children:[e.jsx("span",{children:"âš ï¸"})," ",r.error]}),N.length===0?e.jsxs("div",{className:"bg-[#18181b]/60 backdrop-blur-sm rounded-2xl border border-dashed border-zinc-700 p-16 text-center animate-fade-in",children:[e.jsx("div",{className:"text-7xl mb-6 opacity-20 grayscale",children:"ðŸ“‚"}),e.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:n?"Template tidak ditemukan":"Belum ada template"}),e.jsx("p",{className:"text-zinc-400 mb-8 max-w-md mx-auto",children:n?`Tidak ada hasil untuk kata kunci "${n}". Coba kata lain.`:"Upload template pertamamu (.docx) biar bisa dipake buat generate laporan otomatis."}),!n&&e.jsx("button",{onClick:()=>c(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-zinc-800 text-zinc-200 font-semibold rounded-xl border border-zinc-700 hover:bg-zinc-700 hover:text-white transition-all",children:"Mulai Upload"})]}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:N.map(i=>{var t;return e.jsxs("div",{className:"group relative bg-[#18181b]/80 backdrop-blur-md rounded-2xl border border-white/5 p-6 hover:border-indigo-500/50 hover:bg-zinc-900/90 transition-all duration-300 hover:-translate-y-1 hover:shadow-xl",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/0 via-transparent to-purple-500/0 group-hover:from-indigo-500/10 group-hover:to-purple-500/10 rounded-2xl transition-all duration-500"}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-indigo-500/20 rounded-lg text-indigo-300 border border-indigo-500/20",children:"ðŸ“„"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white line-clamp-1",title:i.name,children:i.name}),e.jsx("p",{className:"text-[10px] text-zinc-500 font-mono",children:new Date(i.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.is_public&&e.jsx("span",{className:"px-2 py-0.5 rounded text-[10px] font-bold bg-sky-500/10 text-sky-400 border border-sky-500/20",children:"PUBLIC"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold border ${i.is_owner?"bg-emerald-500/10 text-emerald-400 border-emerald-500/20":"bg-zinc-800 text-zinc-400 border-zinc-700"}`,children:i.is_owner?"MILIKMU":(t=i.user)==null?void 0:t.name})]}),i.description&&e.jsx("p",{className:"text-sm text-zinc-400 line-clamp-2 h-10 mb-2 leading-relaxed",children:i.description})]}),i.is_owner&&e.jsx("button",{onClick:()=>L(i.id),className:"p-2 text-zinc-500 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Hapus template",children:"ðŸ—‘ï¸"})]}),e.jsx("div",{className:"mt-auto pt-4 border-t border-white/5",children:e.jsxs("button",{onClick:()=>{b(i.id),h("")},className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-zinc-800 text-white text-sm font-bold rounded-xl border border-white/10 hover:bg-indigo-600 hover:border-indigo-500 transition-all group-active:scale-95 shadow-lg",children:[e.jsx("span",{children:"ðŸš€"})," Gunakan Template"]})})]})]},i.id)})})]})}),z&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-[#18181b] rounded-2xl border border-zinc-700 w-full max-w-md max-h-[90vh] overflow-y-auto shadow-2xl relative",children:[e.jsxs("div",{className:"p-6 border-b border-zinc-800 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Upload Template Baru"}),e.jsx("button",{onClick:()=>c(!1),className:"text-zinc-500 hover:text-white transition",children:"âœ–"})]}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1.5",children:"Nama Template"}),e.jsx("input",{type:"text",value:s.name,onChange:i=>m({...s,name:i.target.value}),placeholder:"Contoh: Makalah Kampus",className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 placeholder-zinc-600",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1.5",children:"File (.docx)"}),e.jsx("input",{type:"file",accept:".docx",onChange:i=>m({...s,template_file:i.target.files[0]}),className:"block w-full text-sm text-zinc-400 file:mr-4 file:py-2.5 file:px-4 file:rounded-xl file:border-0 file:bg-indigo-600 file:text-white hover:file:bg-indigo-500 cursor-pointer bg-zinc-900 border border-zinc-700 rounded-xl",required:!0})]}),e.jsxs("div",{className:"p-4 bg-zinc-900/50 border border-zinc-800 rounded-xl flex items-start gap-3",children:[e.jsx("input",{id:"is_public",type:"checkbox",checked:s.is_public,onChange:i=>m({...s,is_public:i.target.checked}),className:"w-5 h-5 rounded border-zinc-600 bg-zinc-800 text-indigo-600 focus:ring-indigo-600"}),e.jsx("label",{htmlFor:"is_public",className:"font-bold text-white text-sm cursor-pointer",children:"Bagikan ke Public?"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-4 py-2.5 bg-zinc-800 text-zinc-300 font-bold rounded-xl hover:bg-zinc-700 border border-zinc-700 transition",children:"Batal"}),e.jsx("button",{type:"submit",disabled:x,className:"flex-1 px-4 py-2.5 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-500 transition",children:x?"Upload...":"Upload"})]})]})})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in overflow-y-auto",children:e.jsxs("div",{className:"bg-[#18181b] rounded-2xl border border-zinc-700 w-full max-w-lg shadow-2xl my-8",children:[e.jsxs("div",{className:"p-6 border-b border-zinc-800",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Persiapan Laporan ðŸš€"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Isi detail dasar dulu biar Cover-nya ganteng."})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1.5",children:"Target Penggunaan"}),e.jsxs("select",{value:o||"",onChange:i=>h(i.target.value),className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"âž• Buat Laporan Baru"}),e.jsx("option",{disabled:!0,children:"â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"}),k.map(i=>e.jsxs("option",{value:i.id,children:["ðŸ“ Timpa Laporan: ",i.judul]},i.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Jenis Laporan"}),e.jsxs("select",{value:a.report_type,onChange:i=>d({...a,report_type:i.target.value}),className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-indigo-500",children:[e.jsx("option",{value:"Makalah",children:"Makalah"}),e.jsx("option",{value:"Laporan Praktikum",children:"Laporan Praktikum"}),e.jsx("option",{value:"Proposal",children:"Proposal"}),e.jsx("option",{value:"Studi Kasus",children:"Studi Kasus"}),e.jsx("option",{value:"Skripsi",children:"Skripsi"}),e.jsx("option",{value:"Tugas Akhir",children:"Tugas Akhir"})]})]}),!o&&e.jsxs("div",{className:"space-y-4 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Judul Laporan"}),e.jsx("input",{type:"text",value:a.judul,onChange:i=>d({...a,judul:i.target.value}),placeholder:"Contoh: Laporan Akhir Praktikum PBO",className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 placeholder-zinc-600"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Mata Kuliah"}),e.jsx("input",{type:"text",value:a.mata_kuliah,onChange:i=>d({...a,mata_kuliah:i.target.value}),placeholder:"Nama Matkul",className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 placeholder-zinc-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"NIM (Opsional)"}),e.jsx("input",{type:"text",value:a.nim,onChange:i=>d({...a,nim:i.target.value}),placeholder:"NIM kamu...",className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 placeholder-zinc-600"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Prodi (Opsional)"}),e.jsx("input",{type:"text",value:a.prodi,onChange:i=>d({...a,prodi:i.target.value}),placeholder:"Jurusan...",className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 placeholder-zinc-600"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-400 mb-1",children:"Instansi (Opsional)"}),e.jsx("input",{type:"text",value:a.instansi,onChange:i=>d({...a,instansi:i.target.value}),placeholder:"Kampus...",className:"w-full px-4 py-2.5 bg-zinc-900 border border-zinc-700 rounded-xl text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 placeholder-zinc-600"})]})]})]}),o&&e.jsxs("div",{className:"p-3 bg-amber-500/10 border border-amber-500/20 rounded-xl flex gap-3 mt-4",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:i=>v(i.target.checked),className:"mt-1 w-4 h-4 rounded border-amber-500/50 bg-amber-900/20 text-amber-500 cursor-pointer"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-amber-400",children:"Timpa Isi Laporan?"}),e.jsx("p",{className:"text-xs text-amber-500/80 mt-0.5",children:"Isi bab yang ada bakal diganti total sama template ini."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>b(null),className:"flex-1 px-4 py-2.5 bg-zinc-800 text-zinc-300 font-bold rounded-xl hover:bg-zinc-700 border border-zinc-700 transition",children:"Batal"}),e.jsx("button",{onClick:_,disabled:x,className:"flex-1 px-4 py-2.5 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-500 shadow-lg shadow-indigo-500/20 transition disabled:opacity-50",children:x?"Memproses...":o?"Terapkan":"Buat Laporan"})]})]})]})})]})}export{A as default};
