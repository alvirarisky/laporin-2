import{r as l,j as e,S as L,x as O,a as $}from"./app-CcNMjsvK.js";import{A as k}from"./AuthenticatedLayout-BLGgl2Cn.js";import"./transition-0YHYq-iH.js";const p={chibi:"/images/chibi-default.png",chibiHappy:"/images/chibi-happy.png",iceCream:"/images/ice-cream.png"},R={1:{justifyContent:"flex-end"},2:{alignItems:"flex-end"},3:{flexDirection:"row-reverse"}},D=t=>{const s={};return(typeof t=="string"?t:"").replace(/\/\*[\s\S]*?\*\//g,"").split(";").forEach(a=>{const[n,i]=a.split(":");if(n&&i){const x=n.trim().replace(/-([a-z])/g,(f,c)=>c.toUpperCase());s[x]=i.trim()}}),s},H=({levels:t,currentLevelIndex:s,progressMap:o})=>{const r=t[s];return e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-black text-white tracking-widest uppercase font-mono mb-2 drop-shadow-md",children:[e.jsx("span",{className:"text-indigo-500",children:"LEVEL"})," ",r==null?void 0:r.level," ",e.jsxs("span",{className:"text-zinc-500 text-lg",children:["/ ",t.length]})]}),e.jsx("div",{className:"flex gap-1.5",children:t.map((a,n)=>{const i=o[a.id]??o[String(a.id)],x=(i==null?void 0:i.status)==="completed",f=n===s;return e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${f?"w-8 bg-indigo-500 shadow-[0_0_8px_#6366f1]":x?"w-2 bg-emerald-500":"w-2 bg-zinc-800"}`},a.id)})})]})},G=({state:t,message:s,tips:o})=>{const r=t==="happy"?p.chibiHappy:p.chibi,a=t==="happy",n=t==="sad";return e.jsxs("div",{className:"flex flex-col items-center w-full relative z-10",children:[e.jsxs("div",{className:`relative mb-3 px-5 py-4 rounded-2xl border text-left w-full shadow-lg transition-all duration-300 ${a?"bg-emerald-500/10 border-emerald-500/50 text-emerald-200":n?"bg-rose-500/10 border-rose-500/50 text-rose-200":"bg-zinc-800/80 border-zinc-700 text-zinc-300"}`,children:[e.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 w-3 h-3 rotate-45 border-b border-r bg-inherit ${a?"border-emerald-500/50":n?"border-rose-500/50":"border-zinc-700"}`}),e.jsx("div",{className:"flex items-center gap-2 mb-1 border-b border-white/5 pb-1",children:e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest opacity-70",children:a?"SUCCESS":n?"OOPS":"HINT"})}),e.jsx("p",{className:"text-sm font-medium leading-relaxed drop-shadow-md whitespace-pre-line",children:s||o})]}),e.jsx("div",{className:"relative h-48 w-full flex justify-center items-end",children:e.jsx("img",{src:r,alt:"Chibi",className:`h-full object-contain transition-transform duration-300 origin-bottom ${a?"animate-happy-hop":"animate-float-slow"} ${n?"grayscale opacity-75":""}`,onError:i=>{i.target.src=p.chibi}})})]})},P=({level:t,userAnswer:s,onChange:o,disabled:r,shake:a,gameType:n})=>{const i=n==="css",x=l.useMemo(()=>i?D(s):{},[s,i]),f=R[t==null?void 0:t.level]||{};return e.jsxs("div",{className:"flex flex-col lg:flex-row gap-5 h-full min-h-[500px]",children:[e.jsxs("div",{className:`lg:w-5/12 w-full bg-[#0d0d0d] rounded-xl overflow-hidden shadow-2xl border border-zinc-800 flex flex-col ${a?"animate-shake":""}`,children:[e.jsxs("div",{className:"bg-[#151515] px-4 py-2 flex items-center justify-between border-b border-zinc-800",children:[e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#ff5f56]"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#ffbd2e]"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-[#27c93f]"})]}),e.jsx("span",{className:"text-zinc-500 text-[10px] font-mono font-bold tracking-wider",children:"CSS EDITOR"})]}),e.jsxs("div",{className:"flex-1 flex relative",children:[e.jsxs("div",{className:"w-8 bg-[#111] border-r border-zinc-800 text-zinc-600 text-xs font-mono pt-4 text-right pr-2 select-none",children:["1",e.jsx("br",{}),"2",e.jsx("br",{}),"3",e.jsx("br",{}),"4"]}),e.jsx("textarea",{spellCheck:"false",className:"flex-1 bg-[#0d0d0d] text-indigo-300 font-mono text-sm p-4 focus:outline-none resize-none leading-loose placeholder-white/10 border-none focus:ring-0",value:s,onChange:c=>o(c.target.value),disabled:r,placeholder:i?`.container {
  /* Bantu Chibi ambil Ice Cream! */
}`:"SELECT ..."})]})]}),e.jsxs("div",{className:"lg:w-7/12 w-full flex flex-col gap-4",children:[e.jsxs("div",{className:"bg-[#151515] rounded-xl p-4 border border-zinc-800 shadow-sm flex gap-3 items-start",children:[e.jsx("div",{className:"bg-indigo-500/20 text-indigo-300 p-2 rounded-lg",children:"ðŸŽ¯"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-zinc-500 text-xs font-bold uppercase tracking-wider mb-1",children:"MISSION GOAL"}),e.jsx("p",{className:"text-zinc-200 text-sm leading-relaxed font-medium",children:t==null?void 0:t.instruction})]})]}),e.jsxs("div",{className:"flex-1 bg-[#1a1a1a] rounded-xl border-4 border-zinc-800 overflow-hidden flex flex-col relative shadow-inner min-h-[300px]",children:[e.jsx("div",{className:"bg-zinc-900 border-b border-zinc-800 px-3 py-2 flex justify-between items-center z-10",children:e.jsxs("span",{className:"text-[10px] font-bold text-zinc-500 uppercase flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"})," LIVE PREVIEW"]})}),e.jsxs("div",{className:"flex-1 relative bg-zinc-900/50 p-6 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(#4f46e5 1px, transparent 1px)",backgroundSize:"20px 20px"}}),i&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 p-6 flex z-0 opacity-50 grayscale transition-all duration-500 pointer-events-none",style:{display:"flex",gap:"12px",alignItems:"flex-start",justifyContent:"flex-start",...f},children:e.jsx("div",{className:"w-20 h-20 flex items-center justify-center animate-pulse",children:e.jsx("img",{src:p.iceCream,alt:"Goal",className:"w-full h-full object-contain drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]"})})}),e.jsx("div",{className:"relative w-full h-full border-2 border-dashed border-zinc-700/50 rounded-xl bg-indigo-900/10 z-10 transition-all duration-500 ease-in-out",style:{display:"flex",gap:"12px",alignItems:"flex-start",justifyContent:"flex-start",...x},children:e.jsx("div",{className:"w-20 h-20 flex items-center justify-center animate-item-bounce transition-all duration-500",children:e.jsx("img",{src:p.chibi,alt:"Player",className:"w-full h-full object-contain drop-shadow-xl"})})})]}),!i&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center font-mono text-zinc-600 gap-3",children:[e.jsx("div",{className:"text-4xl opacity-20",children:"ðŸ—„ï¸"}),e.jsx("div",{className:"text-xs",children:"Database Output Area"})]})]})]})]})]})},U=({level:t,userAnswer:s,onChange:o,disabled:r,shake:a})=>e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 h-full items-stretch",children:[e.jsxs("div",{className:"flex-1 bg-[#1e1e1e] rounded-xl border-4 border-[#3a3a3a] shadow-2xl relative overflow-hidden flex flex-col min-h-[300px]",children:[e.jsx("div",{className:"relative px-6 py-4 border-b border-white/5 flex justify-between items-center",children:e.jsx("span",{className:"text-indigo-400 font-bold text-xs tracking-[0.2em]",children:"PROBLEM STATEMENT"})}),e.jsx("div",{className:"relative p-8 flex-1 flex items-center justify-center",children:e.jsx("p",{className:"text-zinc-200 text-lg md:text-xl font-serif text-center leading-relaxed",children:t==null?void 0:t.instruction})})]}),e.jsxs("div",{className:`flex-1 bg-[#121212] rounded-xl border border-zinc-800 shadow-xl relative flex flex-col min-h-[300px] ${a?"animate-shake":""}`,children:[e.jsx("div",{className:"px-6 py-4 border-b border-zinc-800 bg-[#1a1a1a] rounded-t-xl",children:e.jsx("h3",{className:"text-zinc-500 text-[10px] font-bold uppercase tracking-widest",children:"YOUR ANSWER"})}),e.jsx("div",{className:"flex-1 relative p-6",children:e.jsx("textarea",{value:s,onChange:n=>o(n.target.value),disabled:r,placeholder:"Type answer here...",className:"w-full h-full bg-transparent border-none focus:ring-0 text-zinc-300 text-lg font-mono leading-relaxed resize-none p-0 placeholder-zinc-700"})})]})]});function X({auth:t,game:s,startLevelIndex:o=0,progress:r={}}){const[a]=l.useState((s==null?void 0:s.levels)??[]),[n,i]=l.useState(o),[x,f]=l.useState(""),[c,v]=l.useState(!1),[z,m]=l.useState(""),[S,w]=l.useState(""),[E,N]=l.useState(!1),[I,u]=l.useState("default"),[T,M]=l.useState(r??{}),[Y,A]=l.useState(!1),[y,j]=l.useState(!1),d=l.useMemo(()=>a[n],[a,n]),b=(s==null?void 0:s.game_type)??"quiz",C=b==="css"||b==="sql";l.useEffect(()=>{d&&(f(C?d.initial_code??"":""),m(""),u("default"),j(!1),d.hint?w(d.hint):w("Semangat! Kamu pasti bisa."))},[d,b]);const _=async()=>{if(!(!d||c)){v(!0),m("Sedang memeriksa...");try{const{data:g}=await $.post(route("api.game.checkAnswer"),{level_id:d.id,user_answer:x});g.success?(m("Mantap! Chibi berhasil dapat Ice Cream! ðŸ¦"),u("happy"),N(!0),setTimeout(()=>N(!1),2500),M(h=>({...h,[d.id]:{status:"completed"}})),setTimeout(()=>{const h=n+1;h<a.length?i(h):(A(!0),m("Selamat! Semua misi selesai!"))},1500)):(m(g.message||"Yah, Chibi belum nyampe nih. Coba cek kodingannya lagi."),u("sad"),j(!0),setTimeout(()=>j(!1),400))}catch{m("Error koneksi server."),u("sad")}finally{v(!1)}}};return a.length?e.jsxs(k,{user:t.user,header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"font-bold text-xl text-white",children:s==null?void 0:s.title}),e.jsx(O,{href:route("questify.index"),className:"text-sm text-indigo-400 font-bold hover:text-indigo-300 hover:underline transition-colors",children:"Exit Game"})]}),children:[e.jsx(L,{title:s==null?void 0:s.title}),E&&e.jsx("div",{className:"fixed inset-0 pointer-events-none z-50 overflow-hidden",children:[...Array(40)].map((g,h)=>e.jsx("div",{className:"absolute animate-confetti text-2xl",style:{left:`${Math.random()*100}%`,top:"-5%",animationDuration:`${1+Math.random()}s`},children:["âœ¨","ðŸŽ‰","ðŸ¦","ðŸš€"][Math.floor(Math.random()*4)]},h))}),e.jsx("div",{className:"min-h-screen py-8 bg-[#09090b] font-sans",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx(H,{levels:a,currentLevelIndex:n,progressMap:T}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start",children:[e.jsx("div",{className:"lg:w-3/12 w-full flex flex-col gap-5 sticky top-6 z-20",children:e.jsxs("div",{className:"bg-[#121212] rounded-2xl shadow-xl border border-zinc-800 p-5 flex flex-col items-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-12 left-1/2 -translate-x-1/2 w-32 h-32 bg-indigo-500/5 rounded-full blur-2xl pointer-events-none"}),e.jsx(G,{state:I,message:z,tips:S}),e.jsxs("div",{className:"w-full mt-4 space-y-2 relative z-10",children:[e.jsx("button",{onClick:_,disabled:c||Y,className:`w-full py-3 rounded-xl font-bold text-white shadow-lg transition-all active:scale-95 flex items-center justify-center gap-2 border border-white/5 ${c?"bg-zinc-700 cursor-wait":"bg-gradient-to-r from-indigo-600 to-violet-600 hover:from-indigo-500 hover:to-violet-500"}`,children:c?"Checking...":"RUN CODE â–¶"}),e.jsx("button",{onClick:()=>f(""),className:"w-full py-2 text-xs font-bold text-zinc-500 hover:text-zinc-300 hover:bg-[#1a1a1a] rounded-lg transition uppercase tracking-wider",children:"RESET CODE"})]})]})}),e.jsx("div",{className:"lg:w-9/12 w-full",children:C?e.jsx(P,{level:d,userAnswer:x,onChange:f,disabled:c,shake:y,gameType:b}):e.jsx(U,{level:d,userAnswer:x,onChange:f,disabled:c,shake:y})})]})]})}),e.jsx("style",{children:`
                @keyframes item-bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-6px); } }
                .animate-item-bounce { animation: item-bounce 2s ease-in-out infinite; }
                @keyframes float-slow { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }
                .animate-float-slow { animation: float-slow 3s ease-in-out infinite; }
                @keyframes happy-hop { 0% { transform: translateY(0) scale(1); } 30% { transform: translateY(-15px) scale(1.05) rotate(2deg); } 50% { transform: translateY(0) scale(0.95) rotate(-2deg); } 70% { transform: translateY(-8px) scale(1.02) rotate(1deg); } 100% { transform: translateY(0) scale(1); } }
                .animate-happy-hop { animation: happy-hop 0.6s ease-in-out; }
                @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-4px); } 75% { transform: translateX(4px); } }
                .animate-shake { animation: shake 0.3s ease-in-out; }
                @keyframes confetti { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
                .animate-confetti { animation: confetti 2.5s ease-out forwards; }
            `})]}):e.jsx(k,{user:t.user,children:e.jsx("div",{className:"p-10 text-center text-white",children:"Level kosong."})})}export{X as default};
